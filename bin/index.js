!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.atomicTiming={})}(this,function(e){"use strict";function t(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function n(e){return function(){var n=this,r=arguments;return new Promise(function(o,i){var a=e.apply(n,r);function s(e){t(a,o,i,s,u,"next",e)}function u(e){t(a,o,i,s,u,"throw",e)}s(void 0)})}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){r(e,t,n[t])})}return e}var i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var a,s=(function(e){!function(){var t="undefined"!=typeof window&&window===this?this:void 0!==i&&null!=i?i:this,n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)};function r(){r=function(){},t.Symbol||(t.Symbol=a)}var o=0;function a(e){return"jscomp_symbol_"+(e||"")+o++}function s(){r();var e=t.Symbol.iterator;e||(e=t.Symbol.iterator=t.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&n(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return u(this)}}),s=function(){}}function u(e){var n=0;return function(e){return s(),(e={next:e})[t.Symbol.iterator]=function(){return this},e}(function(){return n<e.length?{done:!1,value:e[n++]}:{done:!0}})}function c(e){s();var t=e[Symbol.iterator];return t?t.call(e):u(e)}function f(e){if(!(e instanceof Array)){e=c(e);for(var t,n=[];!(t=e.next()).done;)n.push(t.value);e=n}return e}var d=0;var p="img script iframe link audio video source".split(" ");function l(e,t){for(var n=(e=c(e)).next();!n.done;n=e.next())if(n=n.value,t.includes(n.nodeName.toLowerCase())||l(n.children,t))return!0;return!1}function m(e,t){if(2<e.length)return performance.now();for(var n=[],r=(t=c(t)).next();!r.done;r=t.next())r=r.value,n.push({timestamp:r.start,type:"requestStart"}),n.push({timestamp:r.end,type:"requestEnd"});for(r=(t=c(e)).next();!r.done;r=t.next())n.push({timestamp:r.value,type:"requestStart"});for(n.sort(function(e,t){return e.timestamp-t.timestamp}),e=e.length,t=n.length-1;0<=t;t--)switch(r=n[t],r.type){case"requestStart":e--;break;case"requestEnd":if(2<++e)return r.timestamp;break;default:throw Error("Internal Error: This should never happen")}return 0}function v(e){e=e||{},this.w=!!e.useMutationObserver,this.u=e.minValue||null,e=window.__tti&&window.__tti.e;var t=window.__tti&&window.__tti.o;this.a=e?e.map(function(e){return{start:e.startTime,end:e.startTime+e.duration}}):[],t&&t.disconnect(),this.b=[],this.f=new Map,this.j=null,this.v=-1/0,this.i=!1,this.h=this.c=this.s=null,function(e,t){var n=XMLHttpRequest.prototype.send,r=d++;XMLHttpRequest.prototype.send=function(o){for(var i=[],a=0;a<arguments.length;++a)i[a-0]=arguments[a];var s=this;return e(r),this.addEventListener("readystatechange",function(){4===s.readyState&&t(r)}),n.apply(this,i)}}(this.m.bind(this),this.l.bind(this)),function(e,t){var n=fetch;fetch=function(r){for(var o=[],i=0;i<arguments.length;++i)o[i-0]=arguments[i];return new Promise(function(r,i){var a=d++;e(a),n.apply(null,[].concat(f(o))).then(function(e){t(a),r(e)},function(e){t(e),i(e)})})}}(this.m.bind(this),this.l.bind(this)),function(e){e.c=new PerformanceObserver(function(t){for(var n=(t=c(t.getEntries())).next();!n.done;n=t.next())if("resource"===(n=n.value).entryType&&(e.b.push({start:n.fetchStart,end:n.responseEnd}),w(e,m(e.g,e.b)+5e3)),"longtask"===n.entryType){var r=n.startTime+n.duration;e.a.push({start:n.startTime,end:r}),w(e,r+5e3)}}),e.c.observe({entryTypes:["longtask","resource"]})}(this),this.w&&(this.h=function(e){var t=new MutationObserver(function(t){for(var n=(t=c(t)).next();!n.done;n=t.next())"childList"==(n=n.value).type&&l(n.addedNodes,p)?e(n):"attributes"==n.type&&p.includes(n.target.tagName.toLowerCase())&&e(n)});return t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}),t}(this.B.bind(this)))}function h(e){e.i=!0;var t=0<e.a.length?e.a[e.a.length-1].end:0,n=m(e.g,e.b);w(e,Math.max(n+5e3,t))}function w(e,t){!e.i||e.v>t||(clearTimeout(e.j),e.j=setTimeout(function(){var t=performance.timing.navigationStart,n=m(e.g,e.b);t=(window.a&&window.a.A?1e3*window.a.A().C-t:0)||performance.timing.domContentLoadedEventEnd-t;if(e.u)var r=e.u;else performance.timing.domContentLoadedEventEnd?r=(r=performance.timing).domContentLoadedEventEnd-r.navigationStart:r=null;var o=performance.now();null===r&&w(e,Math.max(n+5e3,o+1e3));var i=e.a;5e3>o-n?n=null:n=5e3>o-(n=i.length?i[i.length-1].end:t)?null:Math.max(n,r),n&&(e.s(n),clearTimeout(e.j),e.i=!1,e.c&&e.c.disconnect(),e.h&&e.h.disconnect()),w(e,performance.now()+1e3)},t-performance.now()),e.v=t)}v.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t){e.s=t,"complete"==document.readyState?h(e):window.addEventListener("load",function(){h(e)})})},v.prototype.m=function(e){this.f.set(e,performance.now())},v.prototype.l=function(e){this.f.delete(e)},v.prototype.B=function(){w(this,performance.now()+5e3)},t.Object.defineProperties(v.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return[].concat(f(this.f.values()))}}});var y={getFirstConsistentlyInteractive:function(e){return e=e||{},"PerformanceLongTaskTiming"in window?new v(e).getFirstConsistentlyInteractive():Promise.resolve(null)}};e.exports?e.exports=y:window.ttiPolyfill=y}()}(a={exports:{}},a.exports),a.exports),u=function(){var e=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window&&"addEventListener"in window){e.next=2;break}return e.abrupt("return",Promise.resolve({}));case 2:return e.abrupt("return",new Promise(function(e){window.addEventListener("load",function(){setTimeout(n(regeneratorRuntime.mark(function t(){var n,r,i,a,u,c,f,d,p,l,m,v,h,w,y,b;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance){t.next=3;break}return t.abrupt("return",Promise.resolve({}));case 3:if(r=n.timing){t.next=6;break}return t.abrupt("return",Promise.resolve({}));case 6:return t.next=8,s.getFirstConsistentlyInteractive();case 8:i=t.sent,a=window,u=a.__ttfp,c=void 0===u?null:u,f=a.__ttfcp,d=void 0===f?null:f,p=r.domContentLoadedEventEnd-r.fetchStart,l=r.domComplete-r.domLoading,m=r.loadEventEnd-r.fetchStart,v=r.domainLookupEnd-r.domainLookupStart,h=r.redirectEnd-r.redirectStart,w=r.connectEnd-r.connectStart,y=r.responseStart-r.requestStart,b=r.responseEnd-r.responseStart,e(o({},r.toJSON(),{ttci:i,ttfp:c,ttfcp:d,domContentLoaded:p,domProcessingTime:l,pageLoad:m,dnsLookupTime:v,redirectTime:h,tcpConnectionTime:w,ttfb:y,responseProcessingTime:b}));case 19:case"end":return t.stop()}},t,this)})),0)})}));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();e.setup='!function(){"use strict";"PerformanceObserver"in window&&new PerformanceObserver(function(e){var n=!0,r=!1,t=void 0;try{for(var i,o=e.getEntries()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var a=i.value;if(["first-paint","first-contentful-paint"].includes(a.name)){var f="first-paint"===a.name?"__ttfp":"__ttfcp";window[f]=a.startTime+a.duration}}}catch(e){r=!0,t=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw t}}}).observe({entryTypes:["resource","paint"]});if("PerformanceLongTaskTiming"in window){var e=window.__tti={e:[]};e.o=new PerformanceObserver(function(n){e.e=e.e.concat(n.getEntries())}),e.o.observe({entryTypes:["longtask"]})}}();\n',e.measure=u,Object.defineProperty(e,"__esModule",{value:!0})});
